#!/usr/bin/env python3
"""
Realistic Fish Sprites - Based on actual fish anatomy
Professional pixel art quality
"""

from PIL import Image

def sprite_from_string(art, palette, scale=2):
    lines = [line for line in art.strip().split('\n')]
    height = len(lines)
    width = max(len(line) for line in lines) if lines else 0

    img = Image.new('RGBA', (width, height), (0, 0, 0, 0))
    pixels = img.load()

    for y, line in enumerate(lines):
        for x, char in enumerate(line):
            if char != '.' and char in palette:
                pixels[x, y] = palette[char] + (255,)

    if scale > 1:
        img = img.resize((width * scale, height * scale), Image.NEAREST)

    return img

# ===========================================================================
# REALISTIC FISH SPRITES
# ===========================================================================

def make_guppy():
    """Guppy - tiny body, MASSIVE colorful tail fin"""
    palette = {
        '#': (50, 80, 140),
        'b': (70, 110, 180),
        'B': (95, 140, 210),
        'L': (120, 170, 230),
        'T': (180, 30, 30),
        't': (230, 50, 50),
        'r': (255, 80, 70),
        'R': (255, 120, 100),
        'o': (255, 150, 130),
        'O': (255, 180, 160),
        'f': (240, 100, 80),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'x': (30, 50, 100),
    }

    art = """
.......OoR.............................
......OoRrt............................
.....OoRrtT............................
.....oRrtTr............................
....OoRrtTrt...........................
....oRrtTrtT...........................
...OoRrtTrtTr..........................
...oRrtTrtTrt..........................
...OoRrtTrtTr..........................
...oRrtTrtTrTb#........................
...OoRrtTrtxb#B*.......................
...oRrtTrxb#BBL@.......................
...OoRrtxb#BBBLx.......................
....oRrtxb#BBLLx.......................
....OoRtxb#BBLx........................
.....oRtxb#BLLx........................
.....OoRxb#BLx.........................
......oRxb#BLx.........................
.......oxb#BLx.........................
........xb#BLx.........................
.........x#BLx.........................
..........#BLx.........................
...........BLx.........................
............Lx.........................
.............x.........................
"""
    return sprite_from_string(art, palette)

def make_goldfish():
    """Goldfish - plump round body, flowing tail"""
    palette = {
        '#': (180, 90, 0),
        'o': (220, 110, 0),
        'O': (250, 140, 10),
        'g': (255, 180, 40),
        'G': (255, 210, 80),
        'y': (255, 230, 120),
        't': (230, 120, 20),
        'T': (200, 100, 10),
        'f': (240, 150, 50),
        'F': (210, 120, 30),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'd': (120, 60, 0),
    }

    art = """
...................fF..................
..................FffF.................
.................FfogOf................
................FfgGgoO*...............
...............fFgGyGOo#@..............
..............fFgGyygOo##d.............
.........tTtfFOGGyyGOoo##od............
........tTttfOGGyygOoo###od............
.......TTttfOGGygOoo###ood.............
........TttfoGGgOoo###ood..............
.........TtfoGgOoo###ood...............
..........TfoOgoo##ood.................
...........Too##oood...................
............Too#ood....................
.............Toood.....................
..............Tood.....................
...............fFd.....................
................Fd.....................
.................d.....................
"""
    return sprite_from_string(art, palette)

def make_shark():
    """Great white shark - streamlined predator"""
    palette = {
        '#': (50, 60, 70),
        'g': (80, 90, 100),
        'G': (110, 120, 130),
        's': (140, 150, 160),
        'S': (170, 180, 190),
        'w': (200, 205, 210),
        'W': (230, 235, 240),
        'f': (35, 45, 55),
        'F': (65, 75, 85),
        '*': (15, 15, 15),
        'v': (255, 255, 250),
        'x': (25, 30, 35),
    }

    art = """
.......................fF..............
......................FffF.............
.....................Ff##fF............
....................f##gGgf............
...................f#gGsGSf............
..................f#gGsSSwf............
.................f#gGsSwWw#............
................##gGsSWwWw#*...........
...............#gGsSWWwwWw#v...........
..............#gGsSWWwwww##vv..........
.............#gGsSwWwwwww##vvv.........
............##GsSwWwwwww##xvvv.........
...........##gGsSwWwwww##x.............
...........#gGsSSwwwww##x..............
............#gGsSwwww##x...............
.............#gGsSww#gx................
..............#gGsw##gx................
...............#gG##gx.................
................#g#gx..................
.................##gx..................
..................#gx..................
...................#x..................
....................xx.................
.....................x.................
"""
    return sprite_from_string(art, palette)

def make_koi():
    """Koi carp - cylindrical body, orange/white patches"""
    palette = {
        '#': (220, 220, 225),
        'w': (240, 240, 245),
        'W': (255, 255, 255),
        'o': (180, 70, 0),
        'O': (230, 90, 10),
        'r': (255, 110, 30),
        'R': (255, 130, 60),
        'k': (20, 20, 20),
        'K': (50, 50, 50),
        '*': (255, 255, 255),
        '@': (40, 25, 15),
        '-': (70, 70, 70),
        'x': (160, 160, 165),
    }

    art = """
.........rO............................
........rOOw#w*........................
.......rOOow##@--......................
......rOOow##w#--......................
......OOow##ww#w-......................
.....rOow##ww#wk.......................
......Oow##w#wKw#......................
......ow##w#wKw##......................
.......##w#wKw###......................
.......##w#www##w......................
........#w#ww###Or.....................
.........##ww##rOO.....................
..........##w##OrO.....................
...........###rOO......................
............##rO.......................
.............#Ox.......................
..............#x.......................
...............x.......................
"""
    return sprite_from_string(art, palette)

def make_angelfish():
    """Freshwater angelfish - tall triangular profile, stripes"""
    palette = {
        '#': (160, 120, 10),
        'g': (200, 160, 25),
        'G': (235, 190, 45),
        'y': (250, 215, 75),
        'Y': (255, 235, 110),
        '|': (0, 0, 0),
        'b': (20, 20, 20),
        'B': (40, 40, 40),
        'f': (180, 140, 15),
        'F': (140, 100, 10),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'x': (90, 60, 5),
    }

    art = """
..............fyy......................
.............fygGf.....................
............ff|yG#f....................
...........ff||gG#gf...................
...........f||bgG##gf..................
..........ff||bgG*#|f..................
..........f||bbg@##||f.................
.........ff||bbg###||bf................
.........f||bbgg###g||bf...............
.........f||bbgg####||bf...............
.........f||bbgg####g||Bf..............
........ff||bbgg####g|Bbf..............
........f||bbbgg####g|bf...............
........f||bbgg####gg|bf...............
........ff||bgg###gg|bf................
.........f||bgg###g|bff................
.........ff||gg##gg|bf.................
..........f||gg#gg|bf..................
..........ff||g#gg|ff..................
...........f||g#g|bf...................
............f||g#|f....................
............ff||gff....................
.............ff|gf.....................
..............ffgf.....................
...............ffx.....................
................fx.....................
.................x.....................
"""
    return sprite_from_string(art, palette)

def make_dolphin():
    """Bottlenose dolphin - sleek marine mammal"""
    palette = {
        '#': (30, 75, 120),
        'b': (55, 105, 160),
        'B': (80, 135, 195),
        'l': (110, 165, 220),
        'L': (140, 190, 235),
        'w': (190, 205, 220),
        'W': (220, 230, 240),
        'f': (25, 65, 110),
        'F': (45, 90, 140),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'm': (60, 110, 165),
        'x': (20, 55, 95),
    }

    art = """
.................Ff....................
................FffF...................
...............Ff#bF...................
..............f##blLB#.................
.............f#bblWwbB#................
............##bblWWwbBl#...............
...........#bBllWWwwbBlL#*.............
..........#bBLWWwwwwbBllL#@............
.........#bBLWWwwwwbbBllLxmm...........
.........#blLWWwwwbBBllLxx.............
..........#blWWwwbBBllLxx..............
...........#blWwbBBllLxx...............
............#blwBBllLxx................
.............#blBBllxx.................
..............#bBBlLx..................
...............#BBlLx..................
................#Bllx..................
.................fFlx..................
..................Flx..................
...................llx.................
....................lx.................
.....................x.................
"""
    return sprite_from_string(art, palette)

def make_turtle():
    """Sea turtle - domed shell with scutes, flippers"""
    palette = {
        '#': (60, 40, 18),
        's': (95, 65, 30),
        'S': (130, 90, 45),
        'h': (165, 115, 60),
        'H': (200, 145, 80),
        'Y': (220, 165, 95),
        'g': (80, 145, 80),
        'G': (110, 175, 110),
        'l': (140, 200, 140),
        'L': (165, 215, 165),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'x': (45, 30, 15),
    }

    art = """
.............gGl.......................
............GhYHS#sG...................
...........gShYH#s#Ssg*................
..........GgShH##h#sSSGl@..............
.........gGsSH#hHh#SsSSgg..............
........gGgsSH#hYh#SsSsGGg.............
........GggsSS#hSh#SsSsGGg.............
........gggssSSSSSSsSssGgg.............
.........GggssSS##SSsGGgg..............
..........GgggssSSssGGgg...............
...........ggggssSsGGgg................
............ggggsSgGgg.................
.............gggGsggg..................
..............gggGgg...................
...............gggx....................
................ggx....................
.................gx....................
..................x....................
"""
    return sprite_from_string(art, palette)

def make_squid():
    """Squid - torpedo mantle, tentacles, large eyes"""
    palette = {
        '#': (70, 55, 120),
        'p': (100, 75, 155),
        'P': (130, 100, 185),
        'l': (160, 130, 210),
        'L': (185, 155, 225),
        'Y': (205, 180, 235),
        't': (80, 60, 135),
        'T': (60, 45, 110),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'e': (200, 200, 200),
        'x': (50, 35, 90),
    }

    art = """
......tT...............................
.....tTtT..............................
.....TtTt..............................
....tTtTt..............................
....TtTtp#p............................
...tTtTtpP#pP..........................
...TtTtpP#pPl*.........................
...tTtoP#pPPL@.........................
...TtotP#pPLLe.........................
....TotpPpPLLYx........................
....TotpPpPLLYx........................
.....otP#pPLLYx........................
......tP#pPLYYx........................
.......p#pPLYx.........................
........#pPLYx.........................
.........pPLYx.........................
..........PLYx.........................
...........LYx.........................
............Yx.........................
.............x.........................
"""
    return sprite_from_string(art, palette)

def make_discus():
    """Discus fish - circular, laterally compressed"""
    palette = {
        '#': (100, 0, 0),
        'r': (150, 10, 20),
        'R': (200, 20, 40),
        'o': (235, 50, 25),
        'O': (255, 80, 50),
        'y': (255, 110, 75),
        '-': (70, 0, 0),
        '=': (85, 5, 5),
        'f': (180, 30, 35),
        'F': (130, 15, 20),
        '*': (255, 200, 200),
        '@': (100, 0, 0),
        'x': (60, 0, 0),
    }

    art = """
....................fff................
...................f-oyf...............
..................ff=oyrf..............
..................f=-orR#-f............
.................ff=-oR*r=-f...........
.................f=-oR@Rr=-ff..........
................ff=-oRRrr=-ff..........
................f=-orRrr#=-f...........
................f=-orRrr#=-ff..........
................f=-orrr##=-f...........
................ff=-orr##-ff...........
.................f=-or##-ff............
.................ff=-r#=-f.............
..................f==#=-ff.............
...................ff-rff..............
....................ffrff..............
.....................fffx..............
......................ffx..............
.......................fx..............
........................x..............
"""
    return sprite_from_string(art, palette)

def make_eel():
    """Moray eel - long muscular serpentine body"""
    palette = {
        '#': (25, 50, 50),
        't': (40, 70, 70),
        'T': (55, 90, 90),
        'S': (70, 105, 100),
        'g': (100, 140, 130),
        'G': (125, 165, 155),
        'L': (145, 180, 170),
        's': (20, 40, 40),
        '*': (245, 245, 90),
        '@': (0, 0, 0),
        'x': (15, 35, 35),
    }

    art = """
...............................#Tg*....
..............................##TGG@...
.............................##TSGLx...
............................#tTSGGLx...
...........................#tTSGGLx....
..........................#tTSGGgxs....
.........................#tTSGGgx......
........................#tTSGGgx.......
.......................#tTSGGgx........
......................#tTSGGgxs........
.....................#tTSGGgx..........
....................#tTSGGgx...........
...................##TSGGgx............
..................#tTSGGgx.............
.................#tTSGgx...............
................#tTSGgx................
...............#tTSGgxs................
..............#tTSGgx..................
.............#tTSGgx...................
............#tTSGgx....................
...........#tTSGgx.....................
..........#tTSggx......................
.........#tTSggx.......................
........#tTSggx........................
.......#tTSggx.........................
......#tTSggx..........................
.....#tTSggx...........................
....#tTSggx............................
...#tTSggx.............................
..#tTSgxx..............................
.#tTSgx................................
#tTSgx.................................
tTSgx..................................
TSggx..................................
Sggxx..................................
"""
    return sprite_from_string(art, palette)

def make_anglerfish():
    """Deep sea anglerfish - grotesque with bioluminescent lure"""
    palette = {
        '#': (20, 20, 20),
        'b': (35, 35, 35),
        'B': (52, 52, 52),
        'o': (68, 68, 68),
        'O': (85, 85, 85),
        'L': (0, 255, 255),
        'l': (60, 220, 220),
        'g': (100, 235, 235),
        'G': (140, 245, 245),
        '|': (18, 18, 18),
        '*': (160, 160, 160),
        '@': (0, 0, 0),
        'v': (255, 255, 245),
        'x': (12, 12, 12),
    }

    art = """
..................gGL..................
...................||..................
...................||..................
..................||...................
.................b*Bo..................
................bB@Bobvv...............
...............bBBBBobvvv..............
..............bBBBBBobxvvvv............
.............bBBBBBBobxxvvvv...........
............bBBBBBBBbxxxvvv............
.............bBBBBBbxx.................
..............bBBBbxxx.................
...............bBbbxx..................
................bbbxx..................
.................bbxx..................
..................bxx..................
...................xxx.................
....................xx.................
.....................x.................
"""
    return sprite_from_string(art, palette)

def make_oarfish():
    """Oarfish - extremely long ribbonfish with red crest"""
    palette = {
        '#': (130, 130, 135),
        's': (160, 160, 165),
        'S': (190, 190, 195),
        'W': (215, 215, 220),
        'Y': (235, 235, 240),
        'r': (160, 12, 40),
        'R': (200, 20, 50),
        'C': (180, 30, 55),
        'c': (120, 8, 30),
        '*': (255, 255, 255),
        '@': (0, 0, 0),
        'x': (100, 100, 105),
    }

    art = """
......C...C...C...C...C...C...C...C...C...C...C..C*
......c...c...c...c...c...c...c...c...c...c...c.#S@
......#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r#r####x
......Ss#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#RsS#Sx
.......#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#R#s#x..
........x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x.x....
"""
    return sprite_from_string(art, palette)

# ===========================================================================
# MAIN
# ===========================================================================

def main():
    import os
    os.makedirs('assets/fish', exist_ok=True)

    sprites = [
        ('guppy', make_guppy()),
        ('gold', make_goldfish()),
        ('squid', make_squid()),
        ('koi', make_koi()),
        ('angel', make_angelfish()),
        ('discus', make_discus()),
        ('eel', make_eel()),
        ('turtle', make_turtle()),
        ('shark', make_shark()),
        ('dolphin', make_dolphin()),
        ('oarfish', make_oarfish()),
        ('angler', make_anglerfish()),
    ]

    for name, sprite in sprites:
        current_width, current_height = sprite.size
        scale_factor = 128 / current_width
        new_width = 128
        new_height = int(current_height * scale_factor)

        if new_height % 2 != 0:
            new_height += 1

        final = sprite.resize((new_width, new_height), Image.NEAREST)
        path = f'assets/fish/{name}.png'
        final.save(path)
        print(f'  {name:12s} {new_width}x{new_height}')

    print(f'\nGenerated {len(sprites)} realistic pixel art fish!')

if __name__ == '__main__':
    main()
